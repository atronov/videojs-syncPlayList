function syncPlayList(e){"use strict";function t(e){var t,r=e.playListId;return i(r).then(function(o){if(o=JSON.parse(o),t=Number(o[u]),!t)throw new Error("Server time is incorrect or absent:",t);var s=n(o,e);c.playList(s,{getVideoSource:e.getVideoSource&&e.getVideoSource.bind(c)});var a=function(){i(r,t).then(function(r){r=JSON.parse(r),t=Number(r.servertime);var i=n(r,e);c.updatePlayList(i)})["catch"](function(e){console.error(e)}).then(a)};return a(),c})}function r(e){if(!e.playListId&&0!==e.playListId)throw new Error("options.playListId required")}function n(e,t){var r=e[d];return t.rowVideosList&&(r=JSON.parse(r)),r}function i(t,r){var n=e.idParamName||"id",i=e.sinceParamName||"since",s=e.httpMethod||"GET",a=e.httpPath||"/pl",c={};return c[n]=t,r&&(c[i]=r),o(s,a,c)}function o(e,t,r){return new Promise(function(n,i){var o=a(),c=null;r&&("GET"===e?t+="?"+s(r):c=s(r)),o.open(e,t,!0),o.addEventListener("load",function(){200==o.status?n(o.responseText):console.error("Request",t,"has ended with status",o.status)}),o.send(c)})}function s(e){var t=[];for(var r in e)e.hasOwnProperty(r)&&t.push(encodeURIComponent(r)+"="+encodeURIComponent(e[r]));return t.join("&")}function a(){var e;try{e=new ActiveXObject("Msxml2.XMLHTTP")}catch(t){try{e=new ActiveXObject("Microsoft.XMLHTTP")}catch(r){e=!1}}return e||"undefined"==typeof XMLHttpRequest||(e=new XMLHttpRequest),e}var c=this;r(e);var u=e.serverTimeFieldName||"serverTime",d=e.videosFieldName||"videos";return t(e)}videojs.plugin("syncPlayList",syncPlayList);