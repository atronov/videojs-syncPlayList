function playList(e,t){var o=this;o.pl=o.pl||{};var r=parseInt(e,10);o.pl._guessVideoType=function(e){var t={webm:"video/webm",mp4:"video/mp4",ogv:"video/ogg"},o=e.split(".").pop();return t[o]||""},o.pl.init=function(e,t){t=t||{},o.pl.videos=[],o.pl.current=0,o.on("ended",o.pl._videoEnd),t.getVideoSource&&(o.pl.getVideoSource=t.getVideoSource),o.pl._addVideos(e)},o.pl._updatePoster=function(e){o.poster(e),o.removeChild(o.posterImage),o.posterImage=o.addChild("posterImage")};var p=function(e,t){for(var o=0;o<e.length;o++)for(var r=0;r<t.length;r++)if(e[o]&&t[r]&&e[o].src===t[r].src)return!0;return!1};return o.pl._createVideoItem=function(e){for(var t=Object.create(e),r=[],p=0,i=t.src.length;i>p;p++)r.push({type:o.pl._guessVideoType(t.src[p]),src:t.src[p]});return t.src=r,t},o.pl._addVideos=function(e){for(var t=0,r=e.length;r>t;t++){var p=o.pl._createVideoItem(e[t]);o.pl.videos.push(p)}},o.pl._updateVideos=function(e){var t=o.pl.currentVideo,r=e.some(function(e,r){var i=o.pl._createVideoItem(e);return p(t.src,i.src)?(o.pl.current=r,!0):!1});r||o.pl.current>=e.length&&(o.pl.current=e.length-1),o.pl.videos=[],o.pl._addVideos(e)},o.pl._nextPrev=function(e){var t,r;if("next"===e?(t=o.pl.videos.length-1,r=1):(t=0,r=-1),o.pl.current!==t){var p=o.pl.current+r;o.pl._setVideo(p),o.trigger(e,[o.pl.videos[p]])}else if(o.pl.loop&&o.pl.videos.length>0){var i=-1===r?o.pl.videos.length-1:0;o.pl._setVideo(i),o.trigger(e,[o.pl.videos[i]])}},o.pl._setVideo=function(e){e<o.pl.videos.length&&(o.pl.current=e,o.pl.currentVideo=o.pl.videos[e],o.paused()||o.pl._resumeVideo(),o.pl.getVideoSource?o.pl.getVideoSource(o.pl.videos[e],function(e,t){o.pl._setVideoSource(e,t)}):o.pl._setVideoSource(o.pl.videos[e].src,o.pl.videos[e].poster))},o.pl._setVideoSource=function(e,t){o.src(e),o.pl._updatePoster(t)},o.pl._resumeVideo=function(){o.one("loadstart",function(){o.play()})},o.pl._videoEnd=function(){o.pl.current===o.pl.videos.length-1?(o.trigger("lastVideoEnded"),o.pl.loop&&(o.pl._resumeVideo(),o.next())):(o.pl._resumeVideo(),o.next())},e instanceof Array?(o.pl.init(e,t),o.pl._setVideo(0),o):r===r?(o.pl._setVideo(r),o):"string"==typeof e&&"undefined"!=typeof o.pl[e]?(o.pl[e].apply(o),o):void 0}videojs.Player.prototype.next=function(){return this.pl._nextPrev("next"),this},videojs.Player.prototype.prev=function(){return this.pl._nextPrev("prev"),this},videojs.Player.prototype.updatePlayList=function(e){return this.pl._updateVideos(e),this},videojs.plugin("playList",playList);
function syncPlayList(e){"use strict";function t(e){var t,n=e.playListId;return r(n).then(function(i){i=JSON.parse(i),t=Number(i.servertime);var o=i.videos;a.playList(o,{getVideoSource:e.getVideoSource&&e.getVideoSource.bind(a)});var s=function(){r(n,t).then(function(e){e=JSON.parse(e),t=Number(e.servertime);var n=e.videos;a.updatePlayList(n)})["catch"](function(e){console.error(e)}).then(s)};return s(),a})}function n(e){if(!e.playListId&&0!==e.playListId)throw new Error("options.playListId required")}function r(t,n){var r=e.idParamName||"id",o=e.sinceParamName||"since",s=e.httpMethod||"GET",a=e.httpPath||"/pl",u={};return u[r]=t,n&&(u[o]=n),i(s,a,u)}function i(e,t,n){return new Promise(function(r,i){var a=s(),u=null;n&&("GET"===e?t+="?"+o(n):u=o(n)),a.open(e,t,!0),a.addEventListener("load",function(){200==a.status?r(a.responseText):console.error("Request",t,"has ended with status",a.status)}),a.send(u)})}function o(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t.join("&")}function s(){var e;try{e=new ActiveXObject("Msxml2.XMLHTTP")}catch(t){try{e=new ActiveXObject("Microsoft.XMLHTTP")}catch(n){e=!1}}return e||"undefined"==typeof XMLHttpRequest||(e=new XMLHttpRequest),e}var a=this;return n(e),t(e)}videojs.plugin("syncPlayList",syncPlayList);